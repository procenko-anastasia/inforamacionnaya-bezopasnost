# Лабораторная работа: Алгоритм Диффи-Хеллмана

## Содержание
1. [Теоретические основы](#теоретические-основы)
2. [Реализация алгоритма](#реализация-алгоритма)
3. [Пример работы](#пример-работы)
4. [Анализ безопасности](#анализ-безопасности)


---

## Теоретические основы
Алгоритм Диффи-Хеллмана позволяет двум сторонам получить общий секретный ключ через незащищенный канал связи, используя свойства модульной арифметики:
```
K = (g^(a*b)) mod p
```

Где:
- `p` - простое число (модуль)
- `g` - генератор (первообразный корень)
- `a`, `b` - секретные ключи сторон
- `K` - общий секретный ключ

---

## Реализация алгоритма

### 1. Исходный код
```python
# Согласованные параметры
p = 23  # Простое число
g = 5   # Генератор

# Секретные ключи
a = 6   # Секретный ключ Алисы
b = 15  # Секретный ключ Боба

# Вычисление открытых ключей
A = (g ** a) % p  # Открытый ключ Алисы
B = (g ** b) % p  # Открытый ключ Боба

# Вычисление общего ключа
K_alice = (B ** a) % p  # Общий ключ Алисы
K_bob = (A ** b) % p    # Общий ключ Боба
```

---

**Логика работы**

- Генерация общих параметров p и g
- Выбор случайных секретных ключей
- Обмен открытыми ключами
- Вычисление общего секрета

## Пример работы
```
Открытый ключ Алисы: 8
Открытый ключ Боба: 19
Общий ключ Алисы: 2
Общий ключ Боба: 2
```
## Анализ безопасности

### Сильные стороны

| Характеристика | Описание |
|----------------|----------|
| Криптостойкость | Основана на сложности задачи дискретного логарифмирования |
| Безопасный обмен ключами | Позволяет обмениваться ключами по незащищенному каналу |
| Простота реализации | Не требует предварительного обмена секретами |

### Уязвимости и защита

| Тип атаки | Описание | Методы защиты |
|-----------|----------|---------------|
| MITM (Man-in-the-Middle) | Перехват и подмена открытых ключей | 1. Использование цифровых подписей<br>2. Аутентификация сторон |
| Подбор параметра p | Атака на слабые простые числа | 1. Использовать p > 2048 бит<br>2. Проверка простоты числа |
| Повторное использование ключей | Компрометация долговременных ключей | 1. Эфемерные ключи (ECDHE)<br>2. Регулярная ротация ключей |
| Атака по времени | Анализ времени вычислений | 1. Константное время операций<br>2. Маскирование вычислений |
